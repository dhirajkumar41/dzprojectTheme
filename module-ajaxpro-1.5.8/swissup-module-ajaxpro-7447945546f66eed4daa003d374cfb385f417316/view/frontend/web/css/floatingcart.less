/* breakpoints*/

@S:     480px;
@M:     768px;
@L:     1170px;

/* media queries */
/*
.MQ(@canvas) {
  if((@canvas == S), @media only screen and (min-width: @S) { @content; });
  if((@canvas == M), @media only screen and (min-width: @M) { @content; });
  if((@canvas == L), @media only screen and (min-width: @L) { @content; });
}
*/

/* super light grid system */

.column(@percentage, @float-direction:left) {
  width: 100% * @percentage;
  float: @float-direction;
}

/* center vertically and/or horizontally an absolute positioned element */

/*
.center(@xy:xy) {
  @if @xy == xy {
    left: 50%;
    top: 50%;
    bottom: auto;
    right: auto;
    transform: translateX(-50%) translateY(-50%);
  }
  @else if @xy == x {
    left: 50%;
    right: auto;
    transform: translateX(-50%);
  }
  @else if @xy == y {
    top: 50%;
    bottom: auto;
    transform: translateY(-50%);
  }
}
*/

/* border radius */
/*
.border-radius(@radius:.25em) {
  border-radius: @radius;
}
*/

/* clearfix */

.clearfix {
  &::after {
    clear: both;
    content: "";
    display: block;
  }
}

/* color tint and shade */
/*
@function shade(
    @color,
    @percent
  ) {

  @return mix(#000, @color, @percent);
}

@function tint(
    @color,
    @percent
  ) {

  @return mix(#fff, @color, @percent);
}
*/

/* colors */

@color-1: #2b3e51; /* Pickled Bluewood */
@color-2: #2c97de; /* Curious Blue */
@color-3: #ffffff; /* White */
@color-4: #ecf0f1; /* Porcelain */
@color-5: #e94b35; /* Cinnabar */

@z-index1: 900;
@z-index2: 1200;
@z-index3: 1300;

/* fonts  */

@primary-font: 'Source Sans Pro', sans-serif;

.cd-cart-container::before {
    /* dark bg layer visible when the cart is open */
    content: '';
    position: fixed;
    z-index: @z-index1;
    height: 100vh;
    width: 100vw;
    top: 0;
    left: 0;
    background: rgba(0, 0, 0, 0.5);
    opacity: 0;
    visibility: hidden;
    transition: opacity .4s, visibility .4s;
}

.cd-cart-container.cart-open::before {
    opacity: 1;
    visibility: visible;
}

.cd-cart-trigger,
.cd-cart {
    position: fixed;
    bottom: 20px;
    right: 5%;
    transition: transform .2s;
    /* Force Hardware Acceleration in WebKit */
    transform: translateZ(0);
    -webkit-backface-visibility: hidden;
    will-change: transform;
    backface-visibility: hidden;

    .rtl & {
        right: auto;
        left: 5%;
    }

    .empty & {
        /* hide cart */
        transform: translateY(150px);
    }

    @media only screen and (min-width: @L) {
        bottom: 40px;
    }
}

.cd-cart-trigger {
    /* button that triggers the cart content */
    z-index: @z-index3;
    height: 72px;
    width: 72px;
    /* replace text with image */
    text-indent: 100%;
    color: transparent;
    white-space: nowrap;

    &:hover {
        color: transparent;
    }

    &::after, &::before {
        /* used to create the cart/'X' icon */
        content: '';
        position: absolute;
        /*.center()*/
        left: 50%;
        top: 50%;
        bottom: auto;
        right: auto;
        transform: translateX(-50%) translateY(-50%);
        /*.center()*/
        height: 100%;
        width: 100%;
        background: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIwLjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHdpZHRoPSIxNDRweCIgaGVpZ2h0PSI3MnB4IiB2aWV3Qm94PSIwIDAgMTQ0IDcyIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAxNDQgNzIiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMCwgMjApIj4KCQoJCTxsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzM0MzQzNCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgeDE9IjciIHkxPSIxMSIgeDI9IjEzIiB5Mj0iMiIvPgoJCgkJPGxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzQzNDM0IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiB4MT0iMjUiIHkxPSIxMSIgeDI9IjE5IiB5Mj0iMiIvPgoJCgkJPHBvbHlsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzM0MzQzNCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRzPSIKCQkyOCwxNSAyNiwyOSA2LDI5IDQsMTUgCSIvPgoJCgkJPGxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzQzNDM0IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiB4MT0iMSIgeTE9IjExIiB4Mj0iMzEiIHkyPSIxMSIvPgo8L2c+CjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDkyLCAyMCkiPgoJCgkJPGxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzQzNDM0IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiB4MT0iMjciIHkxPSI1IiB4Mj0iNSIgeTI9IjI3Ii8+CgkKCQk8bGluZSBmaWxsPSJub25lIiBzdHJva2U9IiMzNDM0MzQiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHgxPSIyNyIgeTE9IjI3IiB4Mj0iNSIgeTI9IjUiLz4KPC9nPgo8L3N2Zz4K') no-repeat 0 0;
        transition: opacity .2s, transform .2s;
    }

    &::after {
        /* 'X' icon */
        background-position: -72px 0;
        opacity: 0;
        transform: translateX(-50%) translateY(-50%) rotate(90deg);
    }

    .cart-open &::before {
        opacity: 0;
    }

    .cart-open &::after {
        opacity: 1;
        transform: translateX(-50%) translateY(-50%);
    }

    .count {
        /* number of items indicator */
        position: absolute;
        top: -10px;
        right: -10px;
        height: 28px;
        width: 28px;
        background: @color-5;
        color: @color-3;
        font-size: 1.5rem;
        font-weight: bold;
        border-radius: 50%;
        text-indent: 0;
        transition: transform .2s .5s;
        list-style: none;
        padding: 0;
        li {
            /* this is the number of items in the cart */
            position: absolute;
            transform: translateZ(0);
            /*.center;*/
            left: 50%;
            top: 50%;
            bottom: auto;
            right: auto;
            transform: translateX(-50%) translateY(-50%);
            &:last-of-type {
                visibility: hidden;
            }
            padding: 0;
        }

        &.update-count li:last-of-type {
            animation: cd-qty-enter .15s;
            animation-direction: forwards;
        }

        &.update-count li:first-of-type {
            animation: cd-qty-leave .15s;
            animation-direction: forwards;
        }
    }

    .cart-open & .count {
        transition: transform .2s 0s;
        transform: scale(0);
    }

    .empty & .count {
        /* fix bug - when cart is empty, do not animate count */
        transform: scale(1);
    }

    &:hover + div .wrapper {
        box-shadow: 0 6px 40px rgba(0, 0, 0, .3);
    }

    .cart-open &:hover + div .wrapper {
        box-shadow: 0 4px 30px rgba(0, 0, 0, .17);
    }
}

.cd-cart {
    /* cart content */
    z-index: @z-index2;
    width: 90%;
    max-width: 440px;
    height: 400px;
    max-height: 90%;
    pointer-events: none;

    .wrapper {
        position: absolute;
        bottom: 0;
        right: 0;
        .rtl & {
            right: auto;
            left: 0;
        }
        z-index: @z-index2;
        overflow: hidden;
        height: 72px;
        width: 72px;
        border-radius: 6px;
        transition: height .4s .1s, width  .4s .1s, box-shadow .3s;
        transition-timing-function: cubic-bezier(.67,.17,.32,.95);
        background: @color-3;
        box-shadow: 0 4px 30px rgba(0, 0, 0, .17);
        pointer-events: auto;
        .minicart-items-wrapper {
            border: 0;
            margin: 0;
            padding: 0;
            .product-item {
                padding: 10px;
                margin: 0;
                .product.actions {
                    position: absolute;
                    right: 15px;
                    top: 5px;
                    .rtl & {
                        right: auto;
                        left: 15px;
                    }
                }
                .product.actions > div {
                    float: left;
                    margin-left: 15px;
                    .rtl & {
                        float: right;
                        margin-left: 0;
                        margin-right: 15px;
                    }
                }
            }
        }
    }

    header, footer {
        position: absolute;
        z-index: @z-index2;
        left: 0;
        width: 100%;
        box-sizing: border-box;
    }

    header, .body {
        opacity: 0;
    }

    header {
        top: 0;
        border-radius: 6px 6px 0 0;
        padding: 0 1.4em;
        height: 40px;
        line-height: 40px;
        background-color: @color-3;
        transition: opacity .2s 0s;
        /*border-bottom: 1px solid shade(@color-3, 10%);*/
        border-bottom: 1px solid #e6e6e6;
        .clearfix;
    }

    footer {
        bottom: 0;
        border-radius: 0 0 6px 6px;
        box-shadow: 0 -2px 20px rgba(0, 0, 0, .15);
        background: @color-3;
    }

    h2 {
        text-transform: uppercase;
        display: inline-block;
        font-size: 1.4rem;
        font-weight: 700;
        letter-spacing: .1em;
    }

    .undo {
        float: right;
        font-size: 1.2rem;
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s, visibility .2s;
        /*color: tint(@color-1, 40%);*/
        color: #808b97;

        a {
            text-decoration: underline;
            color: @color-1;

            &:hover {
                color: @color-2;
            }
        }

        &.visible {
            opacity: 1;
            visibility: visible;
        }
    }

    .checkout {
        display: block;
        height: 72px;
        line-height: 72px;
        margin-right: 72px;
        .rtl & {
            margin-right: 0;
            margin-left: 72px;
        }
        background: @color-2;
        /*color: rgba(@color-3, 0);*/
        color: rgba(255, 255, 255, 0);
        text-align: center;
        font-size: 1.8rem;
        font-weight: 600;
        transition: all .2s 0s;

        &:hover {
            background: lighten(@color-2, 3%);
        }

        em {
            font-style: normal;
            position: relative;
            display: inline-block;
            transform: translateX(40px);
            transition: transform 0s .2s;
        }

        em::after {
            position: absolute;
            /*.center(y);*/
            top: 50%;
            bottom: auto;
            transform: translateY(-50%);

            right: -25px;
            content: '';
            height: 24px;
            width: 24px;
            background: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIwLjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHdpZHRoPSIyNHB4IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMjQgMjQiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8bGluZSBmaWxsPSJub25lIiBzdHJva2U9IiNGRkZGRkYiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHgxPSIzIiB5MT0iMTIiIHgyPSIyMSIgeTI9IjEyIi8+Cjxwb2x5bGluZSBmaWxsPSJub25lIiBzdHJva2U9IiNGRkZGRkYiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50cz0iCgkxNSw2IDIxLDEyIDE1LDE4ICIvPgo8L3N2Zz4K') no-repeat center center;
            opacity: 0;
            transition: opacity .2s;

            .rtl & {
                right: auto;
                left: -25px;
                transform: rotate(180deg) translateY(-50%);
                transform-origin: 0 0;
            }
        }
    }

    .body {
        position: relative;
        z-index: @z-index1;
        height: ~"calc(100% - 142px)";
        padding: 20px 0 10px;
        margin: 40px 0 10px;
        overflow: auto;
        -webkit-overflow-scrolling: touch;
        transition: opacity .2s;

        ul {
            overflow: hidden;
            position: relative;
            /*padding: 0 1.4em;*/
            /*padding-bottom: 90px;*/
        }

        li {
            position: relative;
            .clearfix;
            opacity: 0;
            transform: translateX(80px);
            transition: opacity 0s .2s, transform 0s .2s;

            &:not(:last-of-type) {
                margin-bottom: 20px;
            }

            &.deleted {
                /* this class is added to an item when it is removed form the cart */
                position: absolute;
                left: 1.4em;
                width: ~"calc(100% - 2.8em)";
                opacity: 0;
                animation: cd-item-slide-out .3s forwards;

                &.undo-deleted {
                    /* used to reinsert an item deleted from the cart when user clicks 'Undo' */
                    animation: cd-item-slide-in .3s forwards;
                }
            }

            &.deleted + li {
                animation: cd-item-move-up-mobile .3s;
                animation-fill-mode: forwards;
            }

            &.undo-deleted + li {
                animation: cd-item-move-down-mobile .3s;
                animation-fill-mode: forwards;
            }
        }
        .subtitle.empty {
            margin: 50px;
        }
    }

    .product-image {
        display: inline-block;
        float: left;
        /* the image height determines the height of the list item - in this case height = width */
        width: 50px;

        img {
            display: block;
        }
    }

    .product-details {
        position: relative;
        display: inline-block;
        float: right;
        width: ~"calc(100% - 50px)";
        padding: 0.3em 0 0 0.5em;
        .clearfix;
    }

    h3, .price {
        font-weight: bold;
    }

    h3 {
        width: 70%;
        float: left;
        /* truncate title with dots if too long */
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;

        a {
            color: @color-1;

            &:hover {
                color: @color-2;
            }
        }
    }

    .price {
        float: right;
        width: 30%;
        text-align: right;
        .rtl & {
            float: left;
            text-align: left;
        }
    }

    .actions {
        font-size: 1.4rem;
        height: 1.6em;
        line-height: 1.6em;
        .clearfix;
    }

    .delete-item, .quantity {
        float: left;
        /*color: tint(@color-1, 40%);*/
        color: #808b97;
        -webkit-backface-visibility: hidden;
        backface-visibility: hidden;
    }

    .delete-item {
        margin-right: 1em;

        &:hover {
            color: @color-5;
        }
    }

    .quantity label {
        display: inline-block;
        margin-right: .3em;
    }

    .select {
        position: relative;
    }

    .select::after {
        /* switcher arrow for select element */
        content: '';
        position: absolute;
        z-index: @z-index1;
        right: 0;
        top: 50%;
        transform: translateY(-50%);
        display: block;
        width: 12px;
        height: 12px;
        background: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIwLjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHZpZXdCb3g9IjAgMCAxMiAxMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMTIgMTI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDpub25lO3N0cm9rZTojODA4Qjk3O3N0cm9rZS1saW5lY2FwOnNxdWFyZTtzdHJva2UtbWl0ZXJsaW1pdDoxMDt9Cjwvc3R5bGU+Cjxwb2x5bGluZSBjbGFzcz0ic3QwIiBwb2ludHM9IjIsNCA2LDggMTAsNCAiLz4KPC9zdmc+Cg==') no-repeat center center;
        pointer-events: none;
    }

    select {
        position: relative;
        padding: 0 1em 0 0;
        cursor: pointer;
        appearance: none;
        background: transparent;
        border: none;
        border-radius: 0;
        font-size: 1.4rem;
        margin: 0;
        /*color: tint(@color-1, 40%);*/
        color: #808b97;

        &:focus {
            outline: none;
            color: @color-1;
            box-shadow: 0 1px 0 currentColor;
        }
    }

    select::-ms-expand {
        /* hide default select arrow on IE */
        display: none;
    }

    .cart-open & .wrapper {
        height: 100%;
        width: 100%;
        transition-delay: 0s;
    }

    .cart-open & header,
    .cart-open & .body {
        opacity: 1;
    }

    .cart-open & header {
        transition: opacity .2s .2s;
    }

    .cart-open & .body {
        transition: opacity 0s;

        li {
            transition: transform .3s .2s, opacity .3s .2s;
            opacity: 1;
            transform: translateX(0);

            &:nth-of-type(2) {
                transition-duration: .4s;
            }

            &:nth-of-type(3) {
                transition-duration: .5s;
            }

            &:nth-of-type(4),
            &:nth-of-type(5) {
                transition-duration: .55s;
            }
        }
    }

    .cart-open & .checkout {
        color: @color-3;
        transition: color .2s .3s;

        em {
            transform: translateX(0);
            transition: transform .2s .3s, padding .2s 0s;
        }

        &:hover em {
            padding-right: 30px;

            .rtl & {
                padding-right: 0;
                padding-left: 30px;
            }

            &::after {
                opacity: 1;
            }
        }
    }

    @media only screen and (min-width: @M) {

        .body li:not(:last-of-type) {
            margin-bottom: 14px;
        }

        .body li.deleted + li {
            animation: cd-item-move-up .3s;
        }

        .body li.undo-deleted + li {
            animation: cd-item-move-down .3s;
        }

        .checkout {
            font-size: 2.4rem;
        }

        .product-image {
            width: 90px;
        }

        .product-details {
            padding: 1.4em 0 0 1em;
            width: ~"calc(100% - 90px)";
        }

        h3, .price {
            font-size: 1.8rem;
        }
        .checkout.btn .price {
            font-size: 2.4rem;
        }
    }
}

@keyframes cd-qty-enter {
    0% {
        opacity: 0;
        visibility: hidden;
        transform: translateX(-50%) translateY(0);
    }
    100% {
        opacity: 1;
        visibility: visible;
        transform: translateX(-50%) translateY(-50%);
    }
}

@keyframes cd-qty-leave {
    0% {
        opacity: 1;
        visibility: visible;
        transform: translateX(-50%) translateY(-50%);
    }
    100% {
        opacity: 0;
        visibility: hidden;
        transform: translateX(-50%) translateY(-100%);
    }
}

@keyframes cd-item-move-up-mobile {
    0% {
        padding-top: 70px;
    }
    100% {
        padding-top: 0px;
    }
}

@keyframes cd-item-move-up {
    0% {
        padding-top: 104px;
    }
    100% {
        padding-top: 0px;
    }
}

@keyframes cd-item-move-down-mobile {
    0% {
        padding-top: 0px;
    }
    100% {
        padding-top: 70px;
    }
}

@keyframes cd-item-move-down {
    0% {
        padding-top: 0px;
    }
    100% {
        padding-top: 104px;
    }
}

@keyframes cd-item-slide-out {
    0% {
        transform: translateX(0);
        opacity: 1;
    }
     100% {
        transform: translateX(80px);
        opacity: 0;
    }
}

@keyframes cd-item-slide-in {
    100% {
        transform: translateX(0);
        opacity: 1;
    }
    0% {
        transform: translateX(80px);
        opacity: 0;
    }
}